<!DOCTYPE html>
<html>
<head>
  <style>
    .container { width: 300px; height: 150px; border: 2px dashed #666; margin: 20px; 
                 display: flex; align-items: center; justify-content: center; position: relative; }
    #drag-me { width: 60px; height: 60px; background: royalblue; color: white; cursor: grab; 
               display: flex; align-items: center; justify-content: center; user-select: none; }
    
    /* Used only while dragging to float over everything */
    .is-dragging { position: fixed !important; pointer-events: none; z-index: 9999; }
  </style>
</head>
<body>
  <h1></hi>Coordinate-Based Drag and Drop</h1>
  <div id="source" class="container">
    <div id="drag-me">DRAG</div>
  </div>

  <div id="target" class="container">DROP HERE</div>

  <script>
    const item = document.getElementById('drag-me');
    const targetZone = document.getElementById('target');
    let offset = { x: 0, y: 0 };

    item.onmousedown = (e) => {
      const rect = item.getBoundingClientRect();
      offset.x = e.clientX - rect.left;
      offset.y = e.clientY - rect.top;
      
      item.classList.add('is-dragging');
      updatePosition(e.clientX, e.clientY);

      function updatePosition(x, y) {
        item.style.left = (x - offset.x) + 'px';
        item.style.top = (y - offset.y) + 'px';
      }

      const onMouseMove = (e) => updatePosition(e.clientX, e.clientY);
      
      // Global listeners ensure we don't "lose" the element if the mouse moves fast
      document.addEventListener('mousemove', onMouseMove);

      document.onmouseup = (e) => {
        document.removeEventListener('mousemove', onMouseMove);
        item.classList.remove('is-dragging');

        // Coordinate-based hit detection
        const dropRect = targetZone.getBoundingClientRect();
        const isInside = (
          e.clientX >= dropRect.left && e.clientX <= dropRect.right &&
          e.clientY >= dropRect.top && e.clientY <= dropRect.bottom
        );

        if (isInside) {
          // 1. Move the element in the DOM (removes from source automatically)
          targetZone.appendChild(item);
          targetZone.innerText = ""; // Clear "DROP HERE" text if desired
          targetZone.appendChild(item);
        }

        // 2. RESET STYLES: This forces it to stay inside the container
        item.style.position = 'static'; 
        item.style.left = '';
        item.style.top = '';
        
        document.onmouseup = null;
      };
    };

    // Disable default browser ghosting
    item.ondragstart = () => false;
  </script>
</body>
</html>
